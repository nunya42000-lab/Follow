@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

:root {
    --bg-main: #000000;
    --card-bg: #121212;
    --seq-bubble: #4f46e5;
    --btn-bg: #1a1a1a;
    --text-main: #e5e5e5;
    --border: rgba(255, 255, 255, 0.15);
}

body {
    background-color: var(--bg-main);
    color: var(--text-main);
    transition: background-color .3s, color .3s;
    min-height: 100vh;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
}

/* Base UI Elements */
.settings-modal-bg { background-color: var(--card-bg) !important; color: var(--text-main) !important; border: 1px solid var(--border); }
.settings-input { background-color: var(--bg-main) !important; color: var(--text-main) !important; border: 1px solid var(--border) !important; }
.bg-primary-app { background-color: var(--seq-bubble) !important; color: var(--text-main); }
.text-primary-app { color: var(--seq-bubble) !important; }

/* Tabs */
.tab-btn { padding: 10px; flex: 1; text-align: center; font-weight: 700; opacity: .6; cursor: pointer; border-bottom: 2px solid transparent; }
.tab-btn.active { border-bottom-color: var(--seq-bubble); opacity: 1; color: var(--seq-bubble); }
.tab-content { display: none; }
.tab-content.active { display: block; }

/* Game Container */
#app { padding-top: 1rem; display: flex; flex-direction: column; }
@media (orientation:landscape) {
    #app { padding-top: 0; }
    #sequence-container { flex-direction: row; flex-wrap: wrap; justify-content: center; gap: .5rem !important; }
}
#sequence-container { justify-content: flex-start !important; padding-top: 1rem; width: 100%; }

/* Buttons */
.btn-input { position: relative; font-weight: 700; border-radius: .75rem; height: 60px; color: var(--text-main); transition: all .1s; }
.btn-pad-number { background-color: var(--btn-bg); font-size: 1.5rem; border: 1px solid var(--border); border-radius: 9999px; }
.btn-pad-number:active { filter: brightness(1.3); transform: scale(.96); }
.btn-pad-number.flash-active { background-color: var(--text-main) !important; color: var(--bg-main) !important; box-shadow: 0 0 15px var(--seq-bubble); transform: scale(1.05); z-index: 10; }

.btn-control { font-size: 1.5rem; height: 60px; border-radius: 9999px; background-color: var(--card-bg); border: 1px solid var(--border); }
.btn-control:active { transform: scale(.95); opacity: .9; }

.number-box { height: 40px; width: 40px; font-size: 1.2rem; font-weight: 800; background-color: var(--seq-bubble); color: var(--text-main); display: flex; align-items: center; justify-content: center; border-radius: .5rem; }

/* Piano */
#piano-keys { position: relative; display: flex; width: 100%; height: 200px; background-color: #111; border-radius: .25rem; overflow: hidden; border: 1px solid var(--border); }
.key-container { width: calc(100% / 7); position: relative; height: 100%; }
.piano-key-white { width: 100%; height: 100%; border: 1px solid #000; background: #fff; color: #000; font-size: 1.5rem; position: absolute; bottom: 0; left: 0; display: flex; align-items: flex-end; justify-content: center; padding-bottom: 10px; }
.piano-key-white:active, .piano-key-white.flash-active { background-color: #fbbf24 !important; }
.piano-key-black { height: 60%; width: 60%; background: #000; position: absolute; top: 0; color: #fff; display: flex; align-items: flex-end; justify-content: center; padding-bottom: 5px; z-index: 20; border: 1px solid #333; }
.piano-key-black:active, .piano-key-black.flash-active { background-color: #fbbf24 !important; color: #000 !important; z-index: 30; }

.black-1 { left: calc((100% / 7)*1 - (10% / 2)); width: 10%; }
.black-2 { left: calc((100% / 7)*2 - (10% / 2)); width: 10%; }
.black-3 { left: calc((100% / 7)*4 - (10% / 2)); width: 10%; }
.black-4 { left: calc((100% / 7)*5 - (10% / 2)); width: 10%; }
.black-5 { left: calc((100% / 7)*6 - (10% / 2)); width: 10%; }

/* Blackout & AR */
#blackout-layer { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000; z-index: 9999; display: none; }
body.blackout-active #blackout-layer { display: block; }

.ar-background-video { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: cover; z-index: -1; }
body.ar-active { background-color: rgba(0, 0, 0, 0.2) !important; }
body.ar-active .card, body.ar-active .btn-input, body.ar-active .number-box { background-color: rgba(18, 18, 18, 0.75) !important; backdrop-filter: blur(4px); }

/* Header */
#aux-control-header { padding-top: max(0.5rem, env(safe-area-inset-top)); background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%); pointer-events: none; }
#aux-control-header button { pointer-events: auto; }
#aux-control-header.header-hidden { transform: translateY(-100%); }
.header-btn-active { background-color: var(--seq-bubble) !important; border-color: var(--text-main) !important; box-shadow: 0 0 10px var(--seq-bubble) !important; }

/* --- BIGGER BUTTONS MODE --- */
body.bigger-buttons-active .control-row { display: none !important; }

body.bigger-buttons-active #pad-key9 .btn-pad-number,
body.bigger-buttons-active #pad-key12 .btn-pad-number {
    height: 85px; font-size: 2.2rem; box-shadow: 0 8px 15px rgba(0,0,0,0.4);
}
body.bigger-buttons-active #piano-keys { height: 300px; }

@media (orientation: landscape) {
    body.bigger-buttons-active #input-footer .max-w-md,
    body.bigger-buttons-active #input-footer .max-w-lg { max-width: 95vw !important; }
    body.bigger-buttons-active #pad-key9 .btn-pad-number,
    body.bigger-buttons-active #pad-key12 .btn-pad-number { height: 18vh; font-size: 2.5rem; width: 100%; }
    body.bigger-buttons-active #piano-keys { height: 50vh !important; }
    body.bigger-buttons-active #input-footer { padding: 5px !important; }
}

/* FULL SCREEN PADDING LOGIC */
body.fullscreen-mode {
    padding-top: 3.5rem !important; 
}
body.fullscreen-mode #aux-control-header {
    padding-top: 2rem !important;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0) 100%);
}
@media (orientation:landscape) {
    body.fullscreen-mode { padding-top: 1.5rem !important; }
    body.fullscreen-mode #aux-control-header { padding-top: 1rem !important; }
}

/* Gestures Mode */
body.input-gestures-mode #input-footer { display: none !important; }
body.input-gestures-mode #gesture-pad-wrapper { display: block !important; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 30; background: rgba(0,0,0,0.05); }
body.input-gestures-mode #gesture-pad { width: 100% !important; height: 100% !important; border: none !important; background: transparent !important; }
