@import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

:root {
    --bg-main: #000000;
    --card-bg: #121212;
    --seq-bubble: #4f46e5;
    --btn-bg: #1a1a1a;
    --text-main: #e5e5e5;
    --border: rgba(255, 255, 255, 0.15);
}

body {
    background-color: var(--bg-main);
    color: var(--text-main);
    transition: background-color .3s, color .3s;
    min-height: 100vh;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    touch-action: manipulation;
}

input,
textarea,
.selectable-text {
    -webkit-user-select: text !important;
    user-select: text !important;
    -webkit-touch-callout: default !important;
    cursor: auto;
    touch-action: auto;
}

.settings-modal-bg {
    background-color: var(--card-bg) !important;
    color: var(--text-main) !important;
    border: 1px solid var(--border);
}

.settings-input {
    background-color: var(--bg-main) !important;
    color: var(--text-main) !important;
    border: 1px solid var(--border) !important;
}

.bg-primary-app {
    background-color: var(--seq-bubble) !important;
    color: var(--text-main);
}

.text-primary-app {
    color: var(--seq-bubble) !important;
}

.tab-btn {
    padding: 10px;
    flex: 1;
    text-align: center;
    font-weight: 700;
    font-size: .9rem;
    border-bottom: 2px solid transparent;
    opacity: .6;
    cursor: pointer;
    transition: all .2s;
}

.tab-btn:hover {
    opacity: .8;
}

.tab-btn.active {
    border-bottom-color: var(--seq-bubble);
    opacity: 1;
    color: var(--seq-bubble);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

#app {
    padding-top: 1rem;
    display: flex;
    flex-direction: column;
}

@media (orientation:landscape) {
    #app {
        padding-top: 0;
    }
    #sequence-container {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        gap: .5rem !important;
    }
    #sequence-container>div {
        margin: 0 !important;
    }
}

#sequence-container {
    justify-content: flex-start !important;
    padding-top: 1rem;
    width: 100%;
}

#input-footer {
    background-color: var(--card-bg);
    border-top: 4px solid var(--seq-bubble);
    padding-bottom: max(.5rem, env(safe-area-inset-bottom));
}

.btn-input {
    transition: all .1s ease-in-out;
    position: relative;
    font-weight: 700;
    border-radius: .75rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, .3);
    height: 60px;
    color: var(--text-main);
    -webkit-user-select: none;
    user-select: none;
}

.btn-pad-number {
    background-color: var(--btn-bg);
    font-size: 1.5rem;
    border: 1px solid var(--border);
    border-radius: 9999px;
}

.btn-pad-number:active {
    filter: brightness(1.3);
    transform: scale(.96);
}

.btn-pad-number.flash-active {
    background-color: var(--text-main) !important;
    color: var(--bg-main) !important;
    box-shadow: 0 0 15px var(--seq-bubble);
    transform: scale(1.05);
    z-index: 10;
}

.btn-control {
    font-size: 1.5rem;
    height: 60px;
    border-radius: 9999px;
    background-color: var(--card-bg);
    color: var(--text-main);
    filter: brightness(.9);
    border: 1px solid var(--border);
}

.btn-control:active {
    transform: scale(.95);
    opacity: .9;
}

.number-box {
    height: 40px;
    width: 40px;
    line-height: 40px;
    font-size: 1.2rem;
    font-weight: 800;
    transition: all .2s;
    background-color: var(--seq-bubble);
    color: var(--text-main);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: .5rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, .2);
}

#piano-keys {
    position: relative;
    display: flex;
    width: 100%;
    height: 200px;
    background-color: #111;
    border-radius: .25rem;
    overflow: hidden;
    border: 1px solid var(--border);
}

.key-container {
    width: calc(100% / 7);
    position: relative;
    height: 100%;
}

.piano-key-white {
    width: 100%;
    height: 100%;
    border: 1px solid #000;
    border-top: none;
    background: #fff;
    color: #000;
    font-weight: 700;
    font-size: 1.5rem;
    position: absolute;
    bottom: 0;
    left: 0;
    z-index: 1;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 10px;
    border-radius: 0 0 2px 2px;
}

.piano-key-white:active,
.piano-key-white.flash-active {
    background-color: #fbbf24 !important;
    color: #000 !important;
    transform: none;
}

.piano-key-black {
    height: 60%;
    width: 60%;
    background: #000;
    position: absolute;
    top: 0;
    z-index: 20;
    color: #fff;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 5px;
    border-radius: 0 0 2px 2px;
    border: 1px solid #333;
}

.piano-key-black:active,
.piano-key-black.flash-active {
    background-color: #fbbf24 !important;
    color: #000 !important;
    transform: none;
    z-index: 30
}

.black-1 {
    left: calc((100% / 7)*1 - (10% / 2));
    width: 10%;
}
.black-2 {
    left: calc((100% / 7)*2 - (10% / 2));
    width: 10%;
}
.black-3 {
    left: calc((100% / 7)*4 - (10% / 2));
    width: 10%;
}
.black-4 {
    left: calc((100% / 7)*5 - (10% / 2));
    width: 10%;
}
.black-5 {
    left: calc((100% / 7)*6 - (10% / 2));
    width: 10%;
}

.vis-bar {
    background-color: var(--seq-bubble);
}

.prompt-box {
    width: 100%;
    padding: .75rem;
    border-radius: .5rem;
    font-family: monospace;
    font-size: .875rem;
    resize: none;
}

#blackout-layer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    z-index: 9999;
    cursor: none;
    touch-action: none;
    display: none;
}

body.blackout-active #blackout-layer {
    display: block;
}

.share-sheet {
    background-color: #1e1e1e !important;
    border-radius: 1.5rem 1.5rem 0 0 !important;
    bottom: 0;
    position: absolute;
    width: 100%;
    border-top: 1px solid #333;
    padding-bottom: 2rem;
    z-index: 100;
    transform: translateY(100%);
    transition: transform .3s ease-out;
}

.share-sheet.active {
    transform: translateY(0);
}

.share-app-icon {
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    background: #333;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

body.hide-controls .control-row {
    display: none !important;
}

/* --- NEW HEADER BAR STYLES --- */
#aux-control-header {
    /* Safe area padding to avoid notch overlap */
    padding-top: max(0.5rem, env(safe-area-inset-top));
    /* Gradient background for visibility over any theme */
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0) 100%);
    /* Pointer events none by default allows clicking through the empty space */
    pointer-events: none;
}

/* When hidden (all buttons inactive), slide it up */
#aux-control-header.header-hidden {
    transform: translateY(-100%);
}

/* Ensure buttons inside capture clicks */
#aux-control-header button {
    pointer-events: auto;
}

/* Active state for header buttons (like mic active) */
.header-btn-active {
    background-color: var(--seq-bubble) !important;
    border-color: var(--text-main) !important;
    box-shadow: 0 0 10px var(--seq-bubble) !important;
}

/* --- INPUT GESTURES MODE (Full Screen) --- */
/* Hide the footer completely */
body.input-gestures-mode #input-footer {
    display: none !important;
}

/* Expand the gesture wrapper to fill screen */
body.input-gestures-mode #gesture-pad-wrapper {
    display: block !important;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 30; /* Below Header (40) but above standard content */
    background: rgba(0, 0, 0, 0.05); /* Very subtle tint to indicate active area */
}

/* Force the pad itself to fill the wrapper */
body.input-gestures-mode #gesture-pad {
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    border: none !important;
    border-radius: 0 !important;
    background: transparent !important;
}

/* Center the help text and ensure it doesn't block touches */
body.input-gestures-mode #gesture-indicator {
    font-size: 1.2rem;
    font-weight: bold;
    opacity: 0.3;
    pointer-events: none;
    color: var(--text-main);
}

/* --- AR MODE STYLES --- */
.ar-background-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: -1; /* Behind everything */
    opacity: 1;
}

/* When AR is active, make the app transparent */
body.ar-active {
    background-color: rgba(0, 0, 0, 0.2) !important; /* Slight tint for readability */
}

/* Make cards and buttons semi-transparent in AR mode */
body.ar-active .card,
body.ar-active .btn-input,
body.ar-active .number-box,
body.ar-active .settings-modal-bg {
    background-color: rgba(18, 18, 18, 0.75) !important;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    border-color: rgba(255, 255, 255, 0.3);
}

body.ar-active header {
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0) 100%);
}
/* --- INPUTS ONLY (STEALTH) MODE STYLES --- */

/* 1. Base Stealth Mode (Portrait) */
body.hide-controls .control-row {
    display: none !important;
}

body.hide-controls #pad-key9 .btn-pad-number,
body.hide-controls #pad-key12 .btn-pad-number {
    height: 85px;             /* Bigger targets */
    font-size: 2.2rem;        /* Bigger text */
    transition: all 0.3s ease;
    box-shadow: 0 8px 15px rgba(0,0,0,0.4);
}

body.hide-controls #piano-keys {
    height: 300px;
    transition: height 0.3s ease;
}

/* 2. LANDSCAPE OVERRIDES ("Really Big") */
@media (orientation: landscape) {
    
    /* Remove the width limits so buttons stretch edge-to-edge */
    body.hide-controls #input-footer .max-w-md,
    body.hide-controls #input-footer .max-w-lg,
    body.hide-controls #input-footer .max-w-2xl {
        max-width: 95vw !important; /* Use 95% of screen width */
    }

    /* Make buttons huge but fit on screen vertically */
    body.hide-controls #pad-key9 .btn-pad-number,
    body.hide-controls #pad-key12 .btn-pad-number {
        height: 18vh;         /* Responsive height (approx 1/5th screen height) */
        font-size: 2.5rem;    /* Huge text */
        width: 100%;          /* Force full width stretch */
    }
    
    /* Ensure footer doesn't have extra padding wasting space */
    body.hide-controls #input-footer {
        padding: 5px !important;
    }
    
    /* Adjust piano for wide screens */
    body.hide-controls #piano-keys {
        height: 50vh !important; /* Use half the screen height */
    }
}
/* --- NEW: Full Screen & Developer Mode Styles --- */

/* Add padding when Full Screen is active to prevent header overlap */
body.fullscreen-mode #app {
    padding-top: 4rem !important; 
}

/* Ensure header background is readable in Full Screen */
body.fullscreen-mode #aux-control-header {
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.9) 20%, rgba(0, 0, 0, 0) 100%);
}

/* Developer Menu specific animations */
#developer-options-modal {
    backdrop-filter: blur(5px);
}

/* Chord Feedback Visuals (Optional, for later) */
.touch-feedback-point {
    position: fixed;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.5);
    background: rgba(255, 255, 255, 0.1);
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 9999;
    transition: background 0.1s, border-color 0.1s;
}
.touch-feedback-point.chord-locked {
    border-color: #00ff00;
    background: rgba(0, 255, 0, 0.2);
    }
